---
- name: Ensure logwatch is absent
  package: name=logwatch state=absent
  when: secure_device_log_email == False

- name: Ensure logwatch is present
  package: name=logwatch state=present
  when: secure_device_log_email != False

- name: Ensure the logwatch configuration is set
  lineinfile:
    path: /usr/share/logwatch/default.conf/logwatch.conf
    line: "{{ item.key }} = {{ item.value }}"
    regexp: "^{{ item.key }} ="
  with_items:
      - Detail: High
      - MailTo: "{{ secure_device_log_email }}"
